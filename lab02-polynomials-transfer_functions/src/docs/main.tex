\documentclass[12pt]{article}
\usepackage[utf8]{inputenc}
\usepackage{amsmath}

\title{ECE 3413 Lab 02\\*Polynomials and Transfer Functions}
\author{Leomar Dur\'an}
\date{$9^{\text{th}}$ February 2023}

\usepackage{siunitx}

\usepackage{titling}
\usepackage{standalone}
\usepackage{pdfpages}
\usepackage{minted}

\usepackage{matlab}
% \newcommand*\matlabtitle\subsection
% \newcommand*\matlabheading\subsubsection
% \newcommand*\mlcell[1]{#1}
% \newenvironment{matlaboutput}{%
    % \minted{matlab}%
% }%
% {%
    % \endminted%
% }%
% \newenvironment{matlabtableoutput}{}{}%

\usepackage{mathtools}%
\DeclarePairedDelimiter\brao()%
\DeclarePairedDelimiter\brac[]%
\DeclarePairedDelimiter\braco[)%
\DeclarePairedDelimiter\Brac\{\}%
\DeclarePairedDelimiter\norm\lVert\rVert%
\DeclarePairedDelimiter\piecefn\{.
\DeclarePairedDelimiter\evalat.|

\def\hr{{\par\noindent\rule{\textwidth}{0.4pt}}}

\begin{document}

\maketitle
\newpage

\section{Introduction}

The purpose of this experiment is to reinforce and build on the introduction to Matlab from Lab 01.

This lab reviews operations on polynomials and teaches how to work with transfer functions.

In this example,
along with converting between the sum and factored forms of polynomials,
we will also experiment with converting between various forms of the transfer function,
namely ratio of polynomials, zero/pole/gain form and the time-domain form.

\section{Procedure}

\subsection{Parts 1.1, 1.2 -- Roots and polynomial forms}

We revisit the use of the representation of polynomials using row vectors of coefficients from highest to lowest order, 
as well as the use of \mintinline{matlab}{poly} to convert roots to the polynomials with those roots and
\mintinline{matlab}{roots} to convert polynomials to their roots.

\subsection{Roots and corresponding phase angles of a polynomial}

In this part of the lab, we model a polynomial in Matlab.
This is done by using a row vector.
Of the operations that can be performed on a row vector, $2$ are the \mintinline{matlab}{conv} and \mintinline{matlab}{roots} functions.

\subsubsection{Convolution}\label{sss:conv}

The \mintinline{matlab}{conv} function is used to convolve two vectors representing polynomial multiplication.

For example, we have the polynomials
\[
    \begin{gathered}
        P_1\brao*s = s^2 + 10s + 24\rlap, \\*
        P_2\brao*s = s^4 + 26s^3 + 231s^2 + 766s + 560\rlap. \\*
    \end{gathered}
\]

These may be represented by the row vectors
\[
    \begin{gathered}
        \vec{v}_1 := \brac*{\begin{matrix} 1 & 10 & 24 \\* \end{matrix}}\rlap, \\*
        \vec{v}_2 := \brac*{\begin{matrix} 1 & 26 & 231 & 766 & 560 \\* \end{matrix}}\rlap. \\*
    \end{gathered}
\]

\pagebreak

Then the convolution $\mathbf{v}_1 \ast \mathbf{v}_2$ represents the product $\brao{P_1 P_2}\brao*s$ as follows

\begin{minted}{matlab}
       [   1  26 231 766 560 ]
[ 24  10   1]                         = 1
    [ 24  10   1]                     = 10+26 = 36
        [ 24  10   1]                 = 24 + 260 + 231 = 515
            [ 24  10   1]             = 624 + 2310 + 766 = 3700
                [ 24  10   1]         = 5544 + 7660 + 560 = 13764
                    [ 24  10   1]     = 18384 + 5600 = 23984
                        [ 24  10   1] = 13440
-----------------------------------------------------------------
[1 10 24]*[1 26 231 766 560] = [1 36 515 3700 13764 23984 13440],
\end{minted}

representing the polynomial
\[
    P\brao*s = s^6 + 36s^5 + 515s^4 + 3700s^3 + 13764s^2 + 23984s + 13440\rlap.
\]

\subsubsection{The roots of the polynomial}

The \mintinline{matlab}{roots} function in Matlab returns the roots of the polynomial $P\brao*s$, that is, the values of $s$ s.t. $P\brao*s = 0$.

\subsection{Transfer functions}

In part 2 of the lab, we model a transfer function and modify one of its coefficients to produce a new output.

We use Matlab to set up the parameters for the transfer functions before using Simulink to model them because Matlab allows for a cleaner interface to set up the parameters.

Additionally, we can use Matlab to perform sanity checks along the way because it echos the value of every statement that is not suppressed by the semicolon character (\mintinline{matlab}{;}).

For example, we can echo the poles, zeros, numerators and denominators of the transfer functions to ensure that we set them up correctly.

Simulink is then used to model the system visually as a block diagram.
The transfer functions are compared by their step responses, their response to a step signal.
The signal starts at $\SI1\volt$, then jumpts to $\SI2\volt$ at $\SI1{\milli\second}$.

\subsubsection{Transfer functions in Matlab}

Matlab has transfer function objects.
These can be represented by objects as a ratio of polynomials using the \mintinline{matlab}{tf} function,
or as their zeros, poles and gain using \mintinline{matlab}{zpk}.
In this lab, we make use of the \mintinline{matlab}{tf} objects.

\subsubsection{Poles}

The poles are the roots of the denominator of the transfer function.
Matlab has the function \mintinline{matlab}{pole},
which accepts a transfer function and returns it poles.

\subsubsection{Zeros}

The zeros are the roots of the numerator of the transfer function.
Matlab has the function \mintinline{matlab}{zero},
which accepts a transfer function and returns it zero.

\subsubsection{The modified transfer function}

We are given the transfer function
\[
    H\brao*s = \frac{s^2 + 10s + 24}{s^4 + 26s^3 + 231s^2 + 766s + 560}\rlap.
\]

I have modified it by negating its pole with the minimum magnitude.

\section{Results}

\hr

\input{part01_poles_zeros_mlx.tex}

\ \hr \\*

\input{part02_laplace_transforms_mlx.tex}

\ \hr \\*

\section{Discussion}

This experiment was straightforward in its procedure.
We learned about how Matlab handles multiplication of polynomials,
and we also experienced a transfer function responding to a signal in a simulated system.

This experiment introduced the idea of stable and unstable transfer functions.
A stable transfer function can be used to attenuate a signal before it gets too far out of bounds.
However, an unstable function may not help with this.

Engineers may have more precise formulas to help choose the correct poles and zeros and properly design a transfer function.


\newpage
\appendix
\title{Appendix}\label{doc:apx}
\addcontentsline{toc}{section}{APPENDICES}
\maketitle

\section{Part 1 -- Poles and zeroes, Matlab Live Script}

\includepdf[pages={-}]{part01_poles_zeros_mlx.pdf}

\section{Part 2 -- Laplace transforms, Matlab Live Script}

\includepdf[pages={-}]{part02_laplace_transforms_mlx.pdf}

\end{document}
