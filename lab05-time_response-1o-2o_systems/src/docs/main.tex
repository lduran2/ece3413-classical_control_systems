\documentclass[12pt]{article}
\usepackage[utf8]{inputenc}
\usepackage{amsmath}
\usepackage[T1]{fontenc}

\title{ECE 3413 Lab 05\\*Time Response of First-\\*and Second-Order Systems}
\author{Leomar Dur\'an}
\date{${10}^{\text{th}}$ March 2023}

\usepackage[natbib,style=apa6]{biblatex}
\addbibresource{main.bib}
\defbibheading{bibliography}[\refname]{%
  \section*{\centering #1}%
}%

\usepackage{hyperref}

\usepackage{cancel}
\usepackage[per-mode=symbol]{siunitx}
\newcommand*\siexpr[2][]{\SI[parse-numbers=false,#1]{#2}}%
\usepackage{xfrac}
\usepackage{amssymb}
\newcommand*\transpose{\mathsf{T}}

\usepackage{mathtools}%
\DeclarePairedDelimiter\brao()%
\DeclarePairedDelimiter\brac[]%
\DeclarePairedDelimiter\braco[)%
\DeclarePairedDelimiter\Brac\{\}%
\DeclarePairedDelimiter\abs||
\DeclarePairedDelimiter\norm\lVert\rVert%
\DeclarePairedDelimiter\piecefn\{.
\DeclarePairedDelimiter\evalat.|

\usepackage{lib/nonfloatenvirons}
\usepackage{booktabs}
\newcommand\ra[1]{\renewcommand*\arraystretch{#1}}
\ra{1.25}
\usepackage{minted}

\usepackage{adjustbox}
\newcommand{\setprime}[2][1]{%
    {#2}^{%
        \raisebox{1pt}{%
            \scalebox{0.5}{%
                \itshape\sffamily\uppercase%
                \expandafter{%
                    \romannumeral#1%
                }%
            }%
        }
    }%
}%
\newcommand*\mcadj[7]%
% {#columns}{col spec}{rotation}{adjust spec}
% {before rotated text}{rotated text}{after rotated text}
{%
    \multicolumn{#1}{#2}{%
        \rlap{%
            #5\adjustbox{rotate=#3,#4}{#6}~#7%
        }%
    }%
}

\usepackage{pdfpages}
\usepackage{standalone}
\usepackage{matlab}

\usepackage[skip=\baselineskip,indent=0pt]{parskip}
\setlength\parindent{0pt}

\usepackage[shortlabels]{enumitem}

\def\hr{{\par\noindent\rule{\textwidth}{0.4pt}}}

\begin{document}

\maketitle
\newpage

\section{Introduction}

The purpose of this experiment is to apply the concept of transfer functions to a translational mechanical system.

The principles used in electrical engineering are shared with other disciplines of engineering.
We can apply these principles to help us look at everyday problems such as a translational system differently,
or we can use this familiarity to better understand the effect of a transfer function in a control system.

This lab also introduces a new type of transfer function, the state-space model which is represented by the \mintinline{matlab}{ss} class in Matlab.

\section{Procedure}

\subsection{Part 01 -- Changing poles}\label{ssc:part 01}

\begin{enumerate}[(a)]
    \item
        Given the transfer function
        \begin{equation}
            G_2\brao*s = \frac{b}{s^2 + as + b},
        \end{equation}
        
        let the damping ratio and natural frequency, respectively $\zeta, \omega_n \in \mathbb{R}$ s.t. $a = 2\zeta\omega_n$ and $b = \omega_n^2$. So
        \begin{equation}
            \piecefn*{
                \begin{matrix}
                    \omega_n = \sqrt{b}\rlap, \\*
                    \zeta = \dfrac{a}{2\sqrt{b}}\rlap. \\*
                \end{matrix}
            }\rlap{$\qquad\brao*{b > 0}$}
        \end{equation}

        Furthermore
        \begin{equation}\label{eq:zwn}
            \zeta\omega_n = \frac{a}2,
        \end{equation}
        and
        \begin{equation}
            \sqrt{1 - \zeta^2} = \sqrt{1 - \brao*{\sfrac{a}{\brao*{2\sqrt{b}}}}^2} = \frac{1}{2\sqrt{b}} \sqrt{4b - a^2}.%
            \hskip1em\brao*{\abs*{a} \leq 2\sqrt{b}}
        \end{equation}
        
        We find that the peak time
        \begin{equation}\label{eq:peak time}
            T_p = \frac\pi{\omega_n \sqrt{1 - \zeta^2}} = \frac\pi{\brao*{\sqrt{b}}\brao*{ \frac{1}{2\sqrt{b}}\sqrt{4b - a^2}}} = \frac{2\pi}{\sqrt{4b - a^2}}.
        \end{equation}

        We find that the overshoot rate
        \begin{equation}\label{eq:overshoot}
            \begin{array}{*2{@{}r}@{}l@{}}\displaystyle
                \% OS
                &{}:={}& \exp\brao*{\frac{-\zeta\pi}{\sqrt{1 - \zeta^2}}} \SI{100}\percent
            \\*[1.3em]
                &{}={}& \exp\brao*{-\zeta\omega_n\brao*{\dfrac{\pi}{\omega_n\sqrt{1 - \zeta^2}}}} \SI{100}\percent
            \\*
                &{}={}& \exp\brao*{-\brao*{\zeta\omega_n}^{\vphantom{1}}T_p} \SI{100}\percent
            \\*
                &{}={}& \exp\brao*{-\brao*{\tfrac{a}2}^{\vphantom{1}}T_p} \SI{100}\percent
            \\*
                & {}={} & \exp\brao*{\dfrac{-aT_p}{2}} \SI{100}\percent\rlap.
            \\*
            \end{array}
        \end{equation}

        We find that the settling time
        \begin{equation}\label{eq:settling time}
            T_s \approx \frac4{\zeta\omega_n} = \frac4{\brao*{\sfrac{a}2}} = \frac8a.
        \end{equation}

        To find rise time, we must first find the step response in the time domain with parameters substituted.

        \subsubsection{Step response}
        We have
        \[
            G_2\brao*s = \frac{b}{s^2 + as + b},
        \]

        Well
        \begin{equation}
            C\brao*s = R\brao*s G_2\brao*s = \frac1s \frac{b}{s^2 + as + b}.
        \end{equation}

        So the second order factor of the denominator
        \begin{equation}\label{eq:sum of squares}
            \begin{aligned}
                s^2 + as + b
                &{} = \brao*{s^2 + 2\brao*{\frac{a}2}s + \brao*{\frac{a}2}^2} + \brao*{b - \brao*{\frac{a}2}^2}
            \\*
                &{} = \brao*{s + \frac{a}2}^2 + \brao*{\sqrt{b - \brao*{\frac{a}2}^2}}^2
                \rlap{
                    $\hskip0.5em\brao*{\abs*{a} \leq 2\sqrt{b}}$
                }
            \\*
                &{}= \brao*{s + \hat{a}}^2 + \omega_d^2.
            \\*
            \end{aligned}
        \end{equation}

        Thus, for $G_2\brao*s$, we have exponential and the damped frequencies
        \begin{equation}\label{eq:Laplace constants}
            \piecefn*{
                \begin{array}{@{}l@{}}
                    \displaystyle
                    \hat{a} = \frac{a}2, \\*
                    \omega_d = \sqrt{b - \hat{a}^2}. \\*
                \end{array}
            }
        \end{equation}

        \paragraph{Note that} the damped frequency and peak time respectively
        \begin{equation}\label{eq: w to-from Tp}
            \begin{array}{c}
            \displaystyle
                \omega_d = \frac\pi{\sfrac{2\pi}{\sqrt{4b - a^2}}} = \frac\pi{T_p}.
            \\*
            \midrule\midrule
            \displaystyle
                T_p = \frac\pi\omega_d.
            \\*
            \end{array}
        \end{equation}

        Thus, we find coefficients $A,B,C$ s.t.
        \begin{equation}
            b = A\brao{s^2 + as + b} + B\brao{s^2 + \hat{a}s} + C\omega_d s.
        \end{equation}

        Asume $s = 0$. Then
        \begin{equation}
            s = 0: b = A\brao{\cancel{\brao*0^2} + \cancel{a\brao*0} + b} + B\brao*{\cancel{\brao*0^2} + \cancel{\hat{a}\brao*0}} + \cancel{C\omega_d \brao*0}.
        \end{equation}
        So $b = Ab$. Thus $A = 1$. Thus
        \begin{equation}
            b = \brao{s^2 + as + b} + B\brao{s^2 + \hat{a}s} + C\omega_d s.
        \end{equation}
        For quadratic terms, we have $0s^2 = s^2 + Bs^2$. So $B = -1$. Thus
        \begin{equation}
            b = \brao{s^2 + as + b} - \brao{s^2 + \hat{a}s} + C\omega_d s.
        \end{equation}
        Finally, for linear terms, we have $0s = as - \hat{a}s + C\omega_d s$. Thus
        \begin{equation}
            C = \frac{\hat{a} - a}\omega_d
            = \frac{\displaystyle\brao*{\frac{a}2} - a}\omega_d
            = \frac{-a}{2\omega_d},\ 
            % = \frac{\displaystyle\brao*{\frac{a}2} - a}{\displaystyle\sqrt{b - \brao*{\frac{a}2}^2} } = \frac{-a}{\sqrt{4b - a^2}}.
            \omega_d = \sqrt{b - \brao*{\frac{a}2}^2} \not= 0.
        \end{equation}

        Then by the inverse Laplace transform, in the time domain, we have step response
        \begin{equation}
            \begin{aligned}
                c\brao*t = \brao*{1 + \brao*{-\cos\brao{\omega_d t} - \frac{a}{2\omega_d} \sin\brao{\omega_d t} }{e^{-\brao*{\sfrac{a}2}t}}}u\brao*t,\ 
                \omega_d = \sqrt{b - \brao*{\frac{a}2}^2}.
            \end{aligned}
        \end{equation}

        After this step, we cannot solve the general case for $t$. So we must first evaluate $c\brao*t$ at some values for $a, \omega_d$.

        \subsubsection{Evaluations}
        Let's evaluate at $a = 4, b = 25$. Well
        \begin{equation}
            \piecefn*{
                \begin{array}{@{}l@{}}
                    b = \brao*{25} > 0,
                \\*
                    \abs{a} = \abs{4} = 4 < 10 = 2\sqrt{\brao{25}} = 2\sqrt{b},
                \\*
                    \omega_d = \sqrt{\brao{25} - \brao*{\dfrac{\brao*4}2}^2} = \sqrt{21} \not= 0
                \\*
                \end{array}
            }
        \end{equation}
        The peak time
        \begin{equation}
            T_p = \frac\pi{\sqrt{21}} = \siexpr{0.6\overline956}\second.
        \end{equation}
        The overshoot rate
        \begin{equation}
                \% OS
                ={} \exp\brao*{\frac{-\brao4\brao{\SI{0.6856}\second}}2} \SI{100}\percent
                = \brao*{0.2\overline53\,802}{\SI{100}\percent}
                = \siexpr{2\overline5.3802}\percent.
        \end{equation}
        The setting time
        \begin{equation}
            T_s \approx \frac84 = \SI2\second.
        \end{equation}

        For the rise time, in the time domain, the step response
        \begin{equation}
            \begin{aligned}
                c\brao*t = \brao*{1 + \brao*{-\cos\brao{\omega_d t} - \frac{a}{2\omega_d} \sin\brao{\omega_d t} }{e^{-\brao*{\sfrac{a}2}t}}}u\brao*t.
            \end{aligned}
        \end{equation}

        Assuming that $a > 0$, then the final value is s.t.
        \begin{equation}
            c\brao*t
            \xrightarrow{t\to+\infty} \brao*{1 + \brao*{-\cos\brao{\omega_d t} - \frac{a}{2\omega_d} \sin\brao{\omega_d t} }\cancel{\brao*{e^{-\brao*{\sfrac{a}2}t}}}^0} \cancel{u\brao*t}^1 = 1 = c_f.
        \end{equation}

        Thus, the $\SI{90}\percent$ and $\SI{10}\percent$ values are $.9c_f = 0.9$ and $.1c_f = 0.1$ respectively.

        Well $a = 4,\ \omega_d = \sqrt{21} \not= 0$.
        Using these known values, we can use the script in Appendix subsection~\ref{sap:solving for .9cf and .1cf}, we find the times corresponding to these values
        \begin{equation}
            \brac*{
                \begin{matrix}
                    t_{.9f} \\*
                    t_{.1f} \\*
                \end{matrix}
            }
            =
            \brac*{
                \begin{matrix}
                    \SI{0.388761}\second \\*
                    \SI{0.096063}\second \\*
                \end{matrix}
            }\rlap.
        \end{equation}
        Thus, rise time $T_r = t_{.9f} - t_{.1f} = \SI{0.388761}\second - \SI{0.096063}\second = \SI{0.292698}\second$.

        \subsubsection{Plotting the poles and zeroes}\label{sss:poles-zeros}

        In \eqref{eq:sum of squares}, we found that the denominator of transfer function $G_2\brao*s$ is $s^2 + as + b = \brao{s + \hat{a}}^2 + \omega_d^2$.

        Thus the poles $s$ s.t.
        \begin{equation}
            \begin{aligned}
                0 &{}= \brao*{s + \hat{a}}^2 + \omega_d^2
            \\*
                  &{}= \brao*{s + \hat{a}}^2 - \brao*{j\omega_d}^2
            \\*
                  &{}= \brao*{s + \brao*{\hat{a} - j\omega_d}}\brao*{s + \brao*{\hat{a} + j\omega_d}},
            \\*
            \end{aligned}
        \end{equation}
        that is
        \begin{equation}\label{eq:poles}
            \begin{aligned}
                s_{1,2} = -\hat{a} \pm j\omega_d
            %\\*
                = -\frac{a}2 \pm j\omega_d
                \rlap.
            %\\*
            \end{aligned}
        \end{equation}

        Substituting in the parameters, the poles
        \begin{equation}
            s_{1,2} = -\frac42 \pm j\sqrt{21} = -2 \pm j\sqrt{21}\rlap.
        \end{equation}

        Now, although the poles and zeros may be plotted with the built-in Matlab function \mintinline{matlab}{pzmap}, which accepts a transfer function or system and plots its zeroes and poles,
        I have written the Matlab script in Appendix subsection~\ref{sap:pzplot} showing how it works with results in Fig.~\ref{fig:part01_pzplot_pzmap}.

    \item
        \subsubsection{Effect of the pole's real and imaginary parts}
        \paragraph{On the parameters}
        From \eqref{eq:poles} and since $\abs*{a} \leq 2\sqrt{b}$, $\omega_d\in\mathbb{R}$. So let $s_0\in s_{1,2}$, then $s_{1,2} = \mathfrak{Re}\brao*{s_0} \pm j\mathfrak{Im}\brao*{s_0}$ and
        the real part of $s_0$,
        \begin{equation}\label{eq:Re(s0)}
            \mathfrak{Re}\brao*{s_0} := \frac{s_1 + s_2}2
            %= -\hat{a}
            = -\frac{a}2\rlap,
        \end{equation}
        and the imaginary part
        \begin{equation}\label{eq:Im(s0)}
            \mathfrak{Im}\brao*{s_0} := \abs*{\frac{s_1 - s_2}{2j}} = \omega_d = \sqrt{b - \hat{a}^2} = \sqrt{b - \brao*{\frac{a}2}^2}\rlap.
        \end{equation}

        Thus, we have parameters $a,b$ s.t. $a = -2 \mathfrak{Re}\brao*{s_0}$, and
        \begin{equation}
            \begin{aligned}
                b &{}= \mathfrak{Im}^2\brao*{s_0} + \hat{a}^2
            \\*
                & {}= \mathfrak{Im}^2\brao*{s_0} + \brao*{-\mathfrak{Re}\brao*{s_0}}^2
            \\*
                & {}= \brao*{\mathfrak{Re}^2 + \mathfrak{Im}^2}\brao*{s_0}.
            \\*
            \end{aligned}
        \end{equation}

        Let $m,n \in \mathbb{R}$, and let $\setprime{s}_0 \in \setprime{s}_{1,2} = m\mathfrak{Re}\brao*{s_0} \pm jn\mathfrak{Im}\brao*{s_0}$ s.t.
        \begin{equation}
            \piecefn*{
                \begin{matrix}
                    \mathfrak{Re}\brao*{\setprime{s}_0} = m\mathfrak{Re}\brao*{s_0},
                \\*
                    \mathfrak{Im}\brao*{\setprime{s}_0} = n\mathfrak{Im}\brao*{s_0}.
                \\*
                \end{matrix}
            }
        \end{equation}

        Thus the new parameters,
        \begin{equation}
            \piecefn*{
                \begin{array}{@{}l@{}}\displaystyle
                      \setprime{a}
                    = -2\mathfrak{Re}\brao*{\setprime{s}_0}
                    = -2m\mathfrak{Re}\brao*{s_0}
                    \rlap,
                \\*
                      \setprime{b}
                    = \brao*{\mathfrak{Re}^2 + \mathfrak{Im}^2}\brao*{\setprime{s}_0}
                    = \brao*{\brao*{\tilde{m}\mathfrak{Re}}^2 + \tilde{n}^2\mathfrak{Im}^2}\brao*{s_0}
                    \rlap.
                \\*
                \end{array}
            }
        \end{equation}

        Further, in comparison with the original parameters,
        the new parameters
        \begin{equation}
            \piecefn*{
                \begin{array}{@{}l@{}}\displaystyle
                      \setprime{a}
                    = -2m\brao*{-\frac{a}2}
                    = ma
                    \rlap,
                \\*\displaystyle
                      \setprime{b}
                    = \brao*{\brao*{\brao*m\brao*{-\frac{a}2}}^2 + n^2\brao*{\sqrt{b - \brao*{\frac{a}2}^2}}^2}
                    = \brao*{m^2 - n^2}\brao*{\frac{a}2}^2 + n^2 b
                    \rlap.
                \\*
                \end{array}
            }
        \end{equation}

        \paragraph{On step response characteristics}
        From \eqref{eq: w to-from Tp}, we have peak time
        \begin{equation}\label{eq:peak time, m, n}
            \begin{aligned}
                      \setprime{T}_p
                &{} = \frac\pi{\mathfrak{Im}\brao*{\setprime{s}_0}}
            \\*
                &{} = \frac\pi{n\mathfrak{Im}\brao*{s_0}}
            \\*
                &{} = \frac1n\brao*{\frac\pi{\mathfrak{Im}\brao*{s_0}}}
            \\*
                &{} = \frac{T_p}n
            \\*
                % &{}= \frac{2\pi}{\sqrt{4\setprime{b} - \brao*{\setprime{a}}^2}}
            % \\*
                % &{}= \frac{2\pi}{\sqrt{4\brao*{\brao*{m^2 - n^2}\brao*{\dfrac{a}2}^2 + n^2 b} - \brao*{ma}^2}}
            % \\*
                % &{}= \frac{2\pi}{\abs*n\sqrt{4b - a^2}}
            % \\*
                % &{}= \frac1{\abs*n} \brao*{\frac{2\pi}{\sqrt{4b - a^2}}}
            % \\*
                % &{}= \frac{T_p}{\abs*n}.
            % \\*
            \end{aligned}
        \end{equation}

        From \eqref{eq:overshoot}, we have the rate of overshoot
        \begin{equation}\label{eq:overshoot, m, n}
            \begin{aligned}
                \%\setprime{OS} &{}= \exp\brao*{\dfrac{-\brao*{\setprime{a}}T_p}{2}} \SI{100}\percent
            \\*
                     &{}= \exp\brao*{\dfrac{-\brao*{ma}T_p}{2}} \SI{100}\percent
            \\*
                     &{}= \exp\brao*{\dfrac{-ma T_p}{2}} \SI{100}\percent.
            \\*
                     &{}= \brao*{\frac{\exp\brao*{\dfrac{-a T_p}{2}}\SI{100}\percent}{\SI{100}\percent}}^m \SI{100}\percent.
            \\*
                     &{}= \brao*{\frac{\%OS}{\SI{100}\percent}}^m \SI{100}\percent.
            \\*
            \end{aligned}
        \end{equation}

        From \eqref{eq:settling time}, we have the settling time
        \begin{equation}\label{eq:settling time, m, n}
            \setprime{T}_s \approx \frac8{\setprime{a}} = \frac8{ma} = \frac1m\brao*{\frac8{a}} = \frac{T_s}m.
        \end{equation}

        As stated before, the relationship between parameters $a, b$ and therefore the poles of the transfer function and the rise time are too complicated to calculate in a general form.

        \paragraph{Evaluations on the real part}

        Suppose that we modified the poles, so that the imaginary part stays the same, and the real part is $2\times$.
        So $m = 2,\ n = 1$
        and the roots $\setprime{s}_{1,2} = 2\brao*{-2} \pm j\sqrt{21} = -4 \pm j\sqrt{21}$%
        , plotted in Fig.~\ref{fig:part01_pzplot_pzmap}%
        .
        Then we have the parameters
        \begin{equation}
            \piecefn*{
                \begin{array}{@{}l@{}}\displaystyle
                    \setprime{a} = ma = \brao2\brao4 = 8,
                \\*\displaystyle
                      \setprime{b}
                    = \brao*{m^2 - n^2}\brao*{\frac{a}2}^2 + n^2b
                    = \brao*{\brao2^2 - \brao1^2}\brao*{\frac{\brao4}2}^2 + \brao1^2\brao{25}
                    = 37\rlap.
                \end{array}
            }
        \end{equation}

        Thus the new transfer function
        \begin{equation}
            \setprime{G}_2\brao*s := \frac{37}{s^2 + 8s + 37},
        \end{equation}
        which is used to plot the pole-zero map in Fig.~\ref{fig:part01_pzplot_pzmap}, generated by the Matlab statement \mintinline{matlab}{pzmap(tf(29, [1 8 29]))}

        We saw that peak time is independent of $m$.
        Thus $\setprime{T}_p = T_p = \siexpr{0.6\overline956}\second$. Now
        the rate of overshoot
        \begin{equation}
            \begin{aligned}
                  \%\setprime{OS}
                &{}= \brao*{\frac{\brao*{\brao*{0.2\overline53\,802}\cancel{{\SI{100}\percent}}^{\,1}}}{\cancel{\SI{100}\percent}^{\,1}}}^{\brao*{2}} \SI{100}\percent
            \\*
                &{}= \brao*{0.06\overline4\,415} \SI{100}\percent
            \\*
                &{}= \siexpr{6.\overline4415}\percent.
            \\*
            \end{aligned}
        \end{equation}
        and the settling time
        \begin{equation}
            \setprime{T}_s
            \approx \frac{\brao*{\SI2\second}}{\brao2}
            = \SI1\second.
        \end{equation}

        Now for rise time, we have $\setprime{a} = 8$ and $\setprime\omega_d = \mathfrak{Im}\brao*{\setprime{s}_0} = \sqrt{21}$.
        Thus, the Matlab script in Appendix subsection~\ref{sap:solving for .9cf and .1cf} produces the limits
        \begin{equation}
            \brac*{
                \begin{matrix}
                    \setprime{t}_{.9f} \\*
                    \setprime{t}_{.1f} \\*
                \end{matrix}
            }
            =
            \brac*{
                \begin{matrix}
                    \SI{0.411704}\second \\*
                    \SI{0.082401}\second \\*
                \end{matrix}
            }\rlap,
        \end{equation}
        and rise time $\setprime{T}_r = \SI{0.411704}\second - \SI{0.082401}\second = \SI{0.329303}\second$.

    \item
        \subsubsection{Effect of the pole's imaginary part}
        This time, let's modified the poles, so that the real part stays the same, and the imaginary part is $\frac12\times$.
        So $m = 1,\ n = \sfrac12$
        and the roots $\setprime[2]s_{1,2} = -2 \pm j\brao{\sfrac12}\sqrt{21}$
        , plotted in Fig.~\ref{fig:part01_pzplot_pzmap}%
        . The parameters
        \begin{equation}
            \piecefn*{
                \begin{array}{@{}l@{}}\displaystyle
                    \setprime[2]a = ma = \brao1\brao4 = 4,
                \\*\displaystyle
                      \setprime[2]b
                    = \brao*{m^2 - n^2}\brao*{\frac{a}2}^2 + n^2b
                    = \brao*{\brao1^2 - \brao*{\sfrac12}^2}\brao*{\frac{\brao4}2}^2 + \brao*{\sfrac12}^2\brao{25}
                    = \sfrac{37}4\rlap.
                \end{array}
            }
        \end{equation}

        So the transfer function is
        \begin{equation}
            \setprime[2]{G}_2\brao*s = \frac{\sfrac{37}4}{s^2 + 4s + \tfrac{37}4}.
        \end{equation}

        From \eqref{eq:peak time, m, n}, the peak time
        \begin{equation}
            \setprime[2]{T}_p = \frac{\siexpr{0.6\overline956}\second}{\brao*{\sfrac12}} = \siexpr{1.\overline4712}\second.
        \end{equation}
        In \eqref{eq:overshoot, m, n}, \eqref{eq:settling time, m, n},
        we see that $\%OS,\ T_s$ are independent of $n$.
        Thus $\%\setprime[2]{OS} = \%OS = \siexpr{2\overline5.3802}\percent$ and $\setprime[2]{T}_s \approx T_s \approx \SI2\second$.

        Again for rise time, we have $\setprime[2]a = 4$ and $\setprime[2]\omega_d = \mathfrak{Im}\brao*{\setprime[2]s_0} = \brao*{\sfrac12}\sqrt{21}$.
        Thus, the Matlab script in Appendix subsection~\ref{sap:solving for .9cf and .1cf} produces the limits
        \begin{equation}
            \brac*{
                \begin{matrix}
                    \setprime[2]t_{.9f} \\*
                    \setprime[2]t_{.1f} \\*
                \end{matrix}
            }
            =
            \brac*{
                \begin{matrix}
                    \SI{0.823409}\second \\*
                    \SI{0.164802}\second \\*
                \end{matrix}
            }\rlap,
        \end{equation}
        and rise time $\setprime[2]T_r = \SI{0.823409}\second - \SI{0.164802}\second = \SI{0.658607}\second$.

    \item
        \subsubsection{Effect of the natural frequency}

        \paragraph{On the parameters}
        As we defined earlier, $a = 2\zeta\omega_n$ and $b = \omega_n^2$.
        Let $\nu \in \mathbb{R}$ and let $\setprime[3]\omega_n = \nu\omega_n$.
        Thus
        \begin{equation}
            \piecefn*{
                \begin{array}{@{}l@{}}
                    \setprime[3]a = 2\zeta\setprime[3]\omega_n = 2\zeta\nu\omega_n = \nu\brao{2\zeta\omega_n} = \nu a,
                \\*
                    \setprime[3]b = \brao*{\setprime[3]\omega_n}^2 = \brao*{\nu\omega_n}^2 = \nu^2 b.
                \\*
                \end{array}
            }
        \end{equation}

        \paragraph{On step response characteristics}
        From \eqref{eq:peak time}, \eqref{eq: w to-from Tp},
        the damped frequency for the inverse Laplace transform,
        \begin{equation}
              \omega_d = \omega_n\sqrt{1 - \zeta^2}.
        \end{equation}
        So the new damped frequency
        \begin{equation}
              \setprime[3]\omega_d
            = \setprime[3]\omega_n\sqrt{1 - \zeta^2}
            = \brao*{\nu\omega_n}\sqrt{1 - \zeta^2}
            = \nu\omega_d\rlap.
        \end{equation}
        From \eqref{eq:peak time}, we have peak time
        \begin{equation}
              \setprime[3]T_p
            = \frac\pi{\setprime[3]\omega_d}
            = \frac\pi{\nu\omega_d}
            = \frac1\nu\brao*{\frac\pi\omega_d}
            = \frac{T_p}\nu\rlap.
            % = \frac\pi{\setprime[3]\omega_n \sqrt{1 - \zeta^2}}
            % = \frac\pi{\nu\omega_n \sqrt{1 - \zeta^2}}
            % = \frac1\nu \brao*{\frac\pi{\omega_n \sqrt{1 - \zeta^2}}}
            % = \frac{T_p}\nu\rlap.
        \end{equation}
        From \eqref{eq:overshoot}, we have rate of overshoot
        \begin{equation}
              \%\setprime[3]{OS}
            = \exp\brao*{\frac{-\zeta\pi}{\sqrt{1 - \zeta^2}}} \SI{100}\percent
            = \%OS.
        \end{equation}
        Thus, we see that the natural frequency has no effect on the overshoot.
        However, from \eqref{eq:settling time}, we have settling time
        \begin{equation}
                    \setprime[3]T_s
            \approx \frac4{\zeta\setprime[3]\omega_n}
                  = \frac4{\zeta\brao*{\nu\omega_n}}
                  = \frac1\nu \brao*{\frac4{\zeta\nu\omega_n}}
                  = \frac{T_s}\nu.
        \end{equation}

        \paragraph{Evaluations}
        Suppose that we modify the natural frequency so that it is $4\times$.
        So $\nu = 4$. Thus we have parameters
        \begin{equation}
            \piecefn*{
                \begin{array}{@{}l@{}}
                    \setprime[3]a = \brao*4\brao*4 = 16,
                \\*
                    \setprime[3]b = \brao*4^2 \brao*{25} = 400.
                \\*
                \end{array}
            }
        \end{equation}
        Thus the transfer function
        \begin{equation}
            \setprime[3]G_2\brao*s = \frac{400}{s^2 + 16 + 400}.
        \end{equation}

        So the peak time
        \begin{equation}
              \setprime[3]T_p
            = \frac{\brao{\siexpr{0.6\overline956}\second}}{4}
            = \siexpr{0.1\overline714}\second\rlap,
        \end{equation}
        the rate of overshoot, which is independent of the natural frequency,
        $\%\setprime[3]{OS} = \%OS = \siexpr{2\overline5.3802}\percent$
        and the settling time
        \begin{equation}
                    \setprime[3]T_s
            \approx \frac{\SI2\second}4
                  = \SI{0.5}\second.
        \end{equation}

        From $\setprime[3]a = 16$, $\setprime[3]\omega_d = \brao*{4}\brao*{\sqrt{21}} = 4\sqrt{21}$,
        using the script in Appendix subsection~\ref{sap:solving for .9cf and .1cf},
        we find the limits of the rise time
        \begin{equation}
            \brac*{
                \begin{matrix}
                    \setprime[3]t_{.9f} \\*
                    \setprime[3]t_{.1f} \\*
                \end{matrix}
            }
            =
            \brac*{
                \begin{matrix}
                    \SI{0.097190}\second \\*
                    \SI{0.024016}\second \\*
                \end{matrix}
            }\rlap.
        \end{equation}
        Thus the rise time $\setprime[3]T_r = \SI{0.097190}\second - \SI{0.024016}\second = \SI{0.073175}\second$.

        As for the poles, from \eqref{eq:zwn}, \eqref{eq:Re(s0)},
        \begin{equation}
            \mathfrak{Re}\brao*{s_0} = -\zeta\omega_n,
        \end{equation}
        and with \eqref{eq:Im(s0)}, the poles
        \begin{equation}
            s_{1,2} = -\zeta\omega_n \pm j\omega_d.
        \end{equation}
        So the new poles
        \begin{equation}
              \setprime[3]s_{1,2}
            = -\zeta\setprime[3]\omega_n \pm j\setprime[3]\omega_d
            = -\zeta\brao*{\nu\omega_n} \pm j\brao*{\nu\omega_d}
            = \nu\brao*{-\zeta\omega_n \pm j\omega_d}
            = \nu s_{1,2}.
        \end{equation}
        Thus $\mathfrak{Re}\brao*{\setprime[3]s_0} = \nu\mathfrak{Re}\brao*{s_0}$
        and $\mathfrak{Im}\brao*{\setprime[3]s_0} = \nu\mathfrak{Im}\brao*{s_0}$.
\end{enumerate}

\subsection{Part 02 -- Adding poles}

As \citet{nise2015a} warns,
the step response formulas in \ref{eq:peak time}, \ref{eq:overshoot}, \ref{eq:settling time} are designed only for second order transfer functions with no zeros.
When a transfer function falls outside of those parameters, there are other techniques to analyze it.

\begin{enumerate}[(a)]
    \item
        \subsubsection{Nonpositive real pole with great magnitude}

        If the extra pole is a real, nonpositive $-\alpha_{{R}} \in \mathbb{R}_{\leq 0}$ and has a magnitude much greater than that of the real part of the second order poles,
        then the step response of the transfer function can be approximated by ignoring this extra real pole.

        This is the case with adding the pole $-\alpha_R = -200$, since $+\alpha_R = 200 \gg 2 = \abs*{\mathfrak{Re}\brao*{s_0}}$ of the pole that we found in subsubsection~\ref{sss:poles-zeros}.

    \item
        \subsubsection{Positive real pole}

        Now, if the pole is a real and positive pole $+\alpha_R \in \mathbb{R}_{> 0}$, then this pole adds an addend $\frac{D}{s - \alpha_R}$ to the partial fraction decomposition as in
        \begin{equation}
            C\brao*s = \frac{A}s + \frac{B\brao*{s + \hat{a}}+ C\omega_d}{\brao*{s + \hat{a}}^2 + \omega_d^2} + \frac{D}{s - \alpha_R}.
        \end{equation}

        In the time domain, this addend produces a growing exponential
        \begin{equation}
            c\brao*t = \brao*{
                A + \brao*{
                      B\cos\brao*{\omega_d t}
                    + C\sin\brao*{\omega_d t}^{\vphantom{1}}
                }^{\vphantom{1}}
                e^{-\hat{a}t}
                + De^{\alpha_Rt}
            }u\brao*t
        \end{equation}

        Now we know that
        \begin{equation}
            \brao*{
                A + \brao*{
                      B\cos\brao*{\omega_d t}
                    + C\sin\brao*{\omega_d t}^{\vphantom{1}}
                }^{\vphantom{1}}
                \cancel{\brao*{e^{-\hat{a}t}}}^0
            }\cancel{u\brao*t}^1
            \xrightarrow{t\to+\infty} A.
        \end{equation}
        However
        \begin{equation}
            \brao*{
                De^{\alpha_Rt}
            }
            \xrightarrow{t\to+\infty} +\infty,
        \end{equation}
        that is, the growing exponential component goes to infinity. Thus so does $c\brao*t$ since $\lim_{h\to+\infty} A + h = \lim_{h\to+\infty} h$.
        Because of that, the new transfer function is unstable.
\end{enumerate}

\section{Results}

\subsection{Part 01 -- Changing poles}

\begin{figure}
    \centering
    \includegraphics[width=\linewidth]{img/part01_pzplot_pzmap.eps}
    \caption{Comparison pole-zero plot of the transfer functions in Part 01 (subsection~\ref{ssc:part 01}) using a custom plot function that I made on the left available in Appendix subsection~\ref{sap:pzplot}, and using Matlab's built-in \mintinline{matlab}{pzmap} on the right.}
    \label{fig:part01_pzplot_pzmap}
\end{figure}

We can see in Fig.~\ref{fig:part01_pzplot_pzmap} that none of the variations of $G_2$ will have zeroes as $G_2$ did not either.

The poles with $\mathfrak{Re}\brao{\setprime{s}_0} = 2\mathfrak{Re}\brao{s_0}$ show that manipulating the real part of the poles scales the $x$-component of the pole.

The poles with $\mathfrak{Im}\brao{\setprime[2]s_0} = \brao*{\sfrac12}\mathfrak{Im}\brao{s_0}$ show that manipulating the imaginary part of the poles scales the $y$-component of the pole.

In the Pole-Zero Map on the right in Fig.~\ref{fig:part01_pzplot_pzmap}, we see that the poles with $\setprime[3]\omega_n = 4\omega_n$ show that manipulating the natural frequency of the transfer function scales the magnitude of the pole.

\begin{table}[]
    \centering
    \caption{Proportional relationships of peak time, overshoot and settling time.}
    \[
        \begin{array}{@{}l*3c@{}}
        \toprule
            \text{parameter}
                & \sfrac{\setprime{T}_p}{T_p}
                & \frac{\log\brao*{\frac{\%\setprime{OS}}{\SI{100}\percent}}}{\log{\brao*{\frac{\%OS^{\vphantom1}}{\SI{100}\percent}}}}
                & \sfrac{\setprime{T}_s}{T_s}
        \\*
        \midrule
            \mathfrak{Re}\brao{\setprime{s}_0} = 2\mathfrak{Re}\brao{s_0}
            & 1
            & 2
            & \sfrac12
        \\*
            \mathfrak{Im}\brao{\setprime{s}_0} = \brao*{\sfrac12}\mathfrak{Im}\brao{s_0}
            & 2
            & 1
            & 1
        \\*
            \setprime\omega_n = 4\omega_n
            & \sfrac14
            & 1
            & \sfrac14
        \\*
        \bottomrule
        \end{array}
    \]
    \label{tab:proportions changing poles}
\end{table}

Table~\ref{tab:proportions changing poles} shows the parameter to modify if we want to change any characteristic of the step response. Particularly, we have shown that
\begin{enumerate}[(a)]
    \addtocounter{enumi}1
    \item
        multiplying the real part exponentiates the overshoot and divides the settling time by the same amount, but does not effect peak time,
    \item
        dividing the imaginary part multiplies the peak time by the same amount, but does not effect overshoot or settling time, and
    \item
        multiplying the natural frequency divides peak time and settling time by the same amount, but does not effect overshoot.
\end{enumerate}

\begin{table}[]
    \centering
    \caption{Numerical comparison of rise times from changing poles.}
    \[
        \begin{array}{@{}>$l<$*3{S@{\,}l}@{}}
        \toprule
            \text{parameter}
                & t_{.9f} & \brac*{\si\second}
                & t_{.1f} & \brac*{\si\second}
                & T_r & \brac*{\si\second}
        \\*
        \midrule
            \text{reference}
            & 0.388761 &
            & 0.096063 &
            & 0.292698
        \\*
        \midrule
            $\mathfrak{Re}\brao{\setprime{s}_0} = 2\mathfrak{Re}\brao{s_0}$
            & 0.411704 &
            & 0.082401 &
            & 0.329303
        \\*
            \%error
            & +5.9016 & \si\percent
            & -14.2219 & \si\percent
            & +12.5061 & \si\percent
        \\*
        \midrule
            $\mathfrak{Im}\brao{\setprime{s}_0} = \brao*{\sfrac12}\mathfrak{Im}\brao{s_0}$
            & 0.823409 &
            & 0.164802 &
            & 0.658607
        \\*
            \%error
            & +111.8034 & \si\percent
            & +71.5562 & \si\percent
            & +125.0125 & \si\percent
        \\*
        \midrule
            $\setprime\omega_n = 4\omega_n$
            & 0.097190 &
            & 0.024016 &
            & 0.073175
        \\*
            \%error
            & -75.0001 & \si\percent
            & -74.9997 & \si\percent
            & -74.9998 & \si\percent
        \\*
        \bottomrule
        \end{array}
    \]
    \label{tab:rise time changing poles}
\end{table}

In Table~\ref{tab:rise time changing poles}, we see that for changing the real part, the upper and lower bounds of the rise time chance in opposite directions (positive and negative respectively). This suggests that manipulating the real part causes a widening of both margins for rise time. For changing the imaginary part, both bounds move up by varying amounts, with the rise time itself growing.

Finally, for the settling frequency, we see both bounds and the rise time itself all move by about the same amount ($\SI{-75.0002}\percent$ by harmonic mean).

\subsection{Part 02 -- Adding poles}

\subsubsection{Nonpositive real pole with great magnitude}

\begin{figure}
    \centering
    \includegraphics{img/part02_nonpositive_real_pole.eps}
    \caption{The pole-zero map of the new transfer function on the left, and the comparison of the step response of the original reference transfer function $G_2$ and the resulting transfer function of adding nonpositive real pole $-\alpha_R = -200$ with great magnitude.}
    \label{fig:nonpositive real poles}
\end{figure}

As predicted, we see in Fig.~\ref{fig:nonpositive real poles} that the resulting transfer function is very close to the original reference transfer function.

\begin{table}[]
    \centering
    \caption{Numerical comparison of reference function and the result of adding the pole $-\alpha_R$.}
    \[
        \begin{array}{@{}>$l<$*4{S@{\,}l}@{}}
        \toprule
            name &
            T_p\ & \brac*{\si\second}
                & \%OS &
                & T_s & \brac*{\si\second}
                & T_r & \brac*{\si\second}
        \\*
        \midrule
            reference &
            0.6856 && 25.3802 & \si\percent & 2 && 0.292698
        \\*
            $-\alpha_R$ &
            0.6908 && 25.3746 & \si\percent & 1.6870 && 0.2934
        \\*
        \midrule
            \%error &
            -0.7528 & \si\percent
                & +0.0221 & \si\percent
                & +18.5536 & \si\percent
                & -0.2393 & \si\percent
        \\*
        \bottomrule
        \end{array}
    \]
    \label{tab:nonpositive real poles}
\end{table}

Furthermore, Table~\ref{tab:nonpositive real poles} shows satisfactory errors for peak time, rate of overshoot and rise time.
However, the difference for the settling time is quite high at $\SI{18.5}\percent$. Since Fig.~\ref{fig:nonpositive real poles} is such a close fit, I believe that this may be due to differing definitions of the settling time. Both \citet{nise2015a} and Matlab use a \SI2\percent settling time. However, the difference may come down to the formula from \citet{nise2015a} assuming a settling time from above and Matlab assuming a settling time from below.

\subsubsection{Positive real pole}

\begin{figure}
    \centering
    \includegraphics{img/part02_positive_real_pole.eps}
    \caption{The pole-zero map of the new transfer function on the left, and the comparison of the step response of the original reference transfer function $G_2$ and the resulting transfer function of adding positive real pole $\alpha_R = 200$.}
    \label{fig:positive real poles}
\end{figure}

In this case, we saw the transfer function grow to \num{3.5e+258}, which would trend to positive infinity. Just as predicted, this shows that the new transfer function is unstable.

Further inspection of Table~\ref{tab:positive real poles} shows that the step response has infinite peak time, indeterminate rate of overshoot, settling time and rise time. This is expected because the peak is never reached. As such the peak time would be infinite. The overshoot, settling time and rise time are questions that do not make sense without a possible final value.

\begin{table}[]
    \centering
    \caption{Numerical comparison of reference function and the result of adding the pole $+\alpha_R$.}
    \[
        \begin{array}{@{}>$l<$SSSS@{}}
        \toprule
            name &
            T_p\ \brac*{\si\second}
                & \%OS
                & T_s\ \brac*{\si\second}
                & T_r\ \brac*{\si\second}
        \\*
        \midrule
            reference &
            0.6856 & \SI{25.3802}\percent & 2 & 0.292698
        \\*
            $+\alpha_R$ &
            \text{$+\infty$} & \text{---} & \text{---} & \text{---}
        \\*
        \midrule
            \%error &
            \frac\infty\infty
                & \text{---}
                & \text{---}
                & \text{---}
        \\*
        \bottomrule
        \end{array}
    \]
    \label{tab:positive real poles}
\end{table}

\section{Discussion}

In this lab, we learned that manipulating the real and imaginary parts of the poles will effect their $x$- and $y$-components respectively, and that manipulating the natural frequency will effect the poles' magnitudes.

This lab also gave us the opportunity to test the hypothesis that a positive real pole will always be result in an unstable transfer function, whereas a nonpositive pole will

\newpage
\printbibliography

\newpage
\appendix
\section{Appendix}

\subsection{Part 1 -- Rise time, Matlab script}\label{sap:solving for .9cf and .1cf}
\inputminted{matlab}{src/part01a_rise_time.m}

\subsection{Part 1 -- Pole-zero plot, Matlab Live Script}\label{sap:pzplot}
\inputminted{matlab}{src/part01a_pzplot_mlx.m}

\subsection{Part 2 -- Comparing results of adding poles, Matlab Script}\label{sap:adding poles}
\inputminted{matlab}{src/part02_adding_poles.m}

\end{document}
